---
- name: Create fonts directory
  ansible.builtin.file:
    path: "{{ ansible_user_dir }}/.local/share/fonts"
    state: directory
    mode: "0755"
  when: ansible_distribution == 'Ubuntu'

- name: List font archives
  ansible.builtin.find:
    paths: files/fonts
    patterns: "*.tar.gz"
  register: font_archives
  when: ansible_distribution == 'Ubuntu'

- name: Extract fonts
  ansible.builtin.unarchive:
    src: "{{ item.path }}"
    dest: "{{ ansible_user_dir }}/.local/share/fonts"
    mode: "0644"
  with_items: "{{ font_archives.files }}"
  when: ansible_distribution == 'Ubuntu'

- name: Update font cache
  ansible.builtin.command: fc-cache -f -v
  when: ansible_distribution == 'Ubuntu'
